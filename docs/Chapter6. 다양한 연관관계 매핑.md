# 다양한 연관관계 매핑
엔터티의 연관관계를 매핑할 때 고려해야할 것
1. 다중성
2. 단방향, 양방향
3. 연관관계의 주인

- 다중성
    - 다대일(@ManyToOne)
    - 일대다(@OneToMany)
    - 일대일(@OneToOne)
    - 다대다(@ManyToMany)
- 단방향, 양방향
    - 단방향 : 객체 관계에서 한 쪽만 참조
    - 양방향 : 객체 관계에서 양쪽이 서로 참조
- 연관관계의 주인
  외래 키를 가진 테이블과 매핑한 엔터티가 외래 키를 관리하는 게 효율적이므로 보통 이곳을 연관관계의 주인으로 선택한다. 주인이 아닌 방향은 외래 키를 변경할 수 없고 읽기만 가능하다.
  연관관계의 주인은 mappedBy 속성을 사용하지 않고, 연관관계의 주인이 아니면 mappedBy 속성을 사용하고 **연관관계의 주인 필드 이름을 값으로 입력**해야 한다.

## 다대일
### 다대일 단방향(N:1)
가장 많이 사용하는 연관관계(다대일의 반대는 일대다)

### 다대일 양방향(N:1, 1:N)
- 외래 키가 있는 쪽이 연관관계의 주인이다.
- 항상 서로를 참조하도록 해야한다.

## 일대다
### 일대다 단방향(1:N)
- 일대다 단방향에서는 **일(1)이 연관관계의 주인**이다.
- 테이블 일대다 관계는 항상 다(N)쪽에 외래 키가 있다.
- @JoinColumn을 꼭 사용해야 한다.

일대다 단방향 매핑의 단점
- 엔터티가 관리하는 외래 키가 다른 테이블에 있음
- 연관관계 관리를 위해 추가로 UPDATE SQL 실행

> 일대다 단방향 매핑보다는 **다대일 양방향 매핑을 사용**하자

### 일대다 양방향(1:N, N:1)
일대다 양방향 매핑은 존재하지 않는다. 대신 **다대일 양방향 매핑을 사용**해야 한다.

## 일대일
일대일 관계는 양쪽이 서로 하나의 관계만 가진다.
- 일대일 관계는 그 반대도 일대일 관계다.
- 테이블 관계에서 일대다, 다대일은 항상 다(N)쪽이 외래 키를 가진다. 반면에 일대일 관계는 주 테이블이나 대상 테이블 둘 중 어느 곳이나 외래 키를 가질 수 있다.

### 주 테이블에 외래 키
주 객체가 대상 객체를 참조하는 것처럼 주 테이블에 외래 키를 두고 대상 테이블을 참조한다. 주 테이블이 외래 키를 가지고 있으므로 주 테이블만 확인해도 대상 테이블과 연관관계가 있는지 알 수 있다.

### 대상 테이블에 외래 키
전통적인 데이터베이스 개발자들이 선호하며, 이 방법의 장점은 테이블 관계를 일대일에서 일대다로 변경할 때 테이블 구조를 그대로 유지할 수 있다는 것이다.

## 다대다
관계형 데이터베이스는 정규화된 테이블 2개로 다대다 관계를 표현할 수 없으므로 연결 테이블(조인 테이블)을 추가해서 일대다, 다대일 관계로 풀어내야 한다. **객체는 컬렉션을 사용해서 객체 2개로 다대다 관계가 가능하다.**